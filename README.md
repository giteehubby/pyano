# 🎹 网页钢琴演奏器

一个功能完整的网页版钢琴演奏器，支持键盘和鼠标操作，实现了真实的钢琴音色合成和多音符同时演奏。

## ✨ 主要特性

- **完整音域**: 支持3个八度的全音、半音演奏 (C3-B5)
- **多音符支持**: 可同时演奏多个音符，支持和弦演奏
- **连续播放**: 连续按同一个音时声音不会中断
- **键盘映射**: 支持电脑键盘快捷操作
- **ADSR音色**: 真实的攻击、衰减、持续、释放音色包络
- **延音踏板**: 模拟真实钢琴的延音踏板功能
- **音量控制**: 实时调节演奏音量
- **美观界面**: 现代化的响应式设计，支持移动设备

## 🎵 键盘映射

### 白键
- `A` → C
- `S` → D  
- `D` → E
- `F` → F
- `G` → G
- `H` → A
- `J` → B

### 黑键
- `W` → C#
- `E` → D#
- `T` → F#
- `Y` → G#
- `U` → A#

## 🛠️ 技术栈

### 后端
- **Flask**: Python Web框架
- **NumPy**: 数值计算和音频数据处理
- **SciPy**: 科学计算和信号处理
- **SoundFile**: 音频文件处理

### 前端
- **Web Audio API**: 浏览器原生音频处理
- **HTML5/CSS3**: 现代化界面设计
- **JavaScript ES6+**: 交互逻辑和音频控制

## 📦 安装步骤

### 1. 环境要求
- Python 3.7+
- 现代浏览器 (支持Web Audio API)

### 2. 克隆项目
```bash
git clone <repository-url>
cd pyano
```

### 3. 安装依赖
```bash
pip install -r requirements.txt
```

### 4. 运行应用
```bash
python app.py
```

### 5. 访问应用
打开浏览器访问: `http://localhost:5000`

## 🎮 使用方法

### 基础演奏
1. **鼠标操作**: 直接点击钢琴键
2. **键盘操作**: 使用映射的按键演奏
3. **和弦演奏**: 同时按下多个键

### 控制功能
- **八度选择**: 切换当前键盘映射的八度
- **音量调节**: 使用滑块控制整体音量
- **延音踏板**: 点击按钮开启/关闭延音效果

### 高级技巧
- 开启延音踏板后，音符会持续播放直到踏板关闭
- 可以同时演奏多达10个音符
- 支持快速连击和颤音演奏

## 🎼 音频技术

### 音色合成
- 基础正弦波 + 4个谐波层次
- ADSR包络处理 (攻击0.05s, 衰减0.2s, 释放0.3s)
- 实时音频生成和缓存机制

### 音频格式
- 采样率: 44.1kHz
- 位深度: 32-bit float
- 声道: 单声道

## 🔧 项目结构

```
pyano/
├── app.py                 # Flask主应用
├── requirements.txt       # Python依赖
├── README.md             # 项目文档
├── templates/
│   └── index.html        # 主页模板
└── static/
    ├── css/
    │   └── style.css     # 样式文件
    └── js/
        └── piano.js      # 前端逻辑
```

## 🎯 核心功能实现

### 1. 音频生成
```python
class PianoSynthesizer:
    def generate_tone(self, frequency, duration):
        # 基础正弦波 + 谐波合成
        # ADSR包络处理
        # 音频数据生成
```

### 2. 多音符管理
```javascript
class WebPiano:
    constructor() {
        this.activeNotes = new Map();  // 活动音符管理
        this.audioCache = new Map();   // 音频缓存
    }
```

### 3. 键盘事件处理
- 防止重复触发
- 支持同时按键
- 延音踏板逻辑

## 🚀 性能优化

- **音频缓存**: 预生成音频避免重复计算
- **事件防抖**: 防止键盘重复触发
- **内存管理**: 自动清理停止的音频节点
- **响应式设计**: 适配不同屏幕尺寸

## 🎨 界面特色

- **3D按键效果**: 模拟真实钢琴按键
- **渐变背景**: 现代化视觉设计
- **毛玻璃效果**: 半透明控制面板
- **动画反馈**: 流畅的交互动画

## 🔍 浏览器兼容性

- ✅ Chrome 66+
- ✅ Firefox 60+
- ✅ Safari 14+
- ✅ Edge 79+

## 📱 移动端支持

- 响应式设计适配手机和平板
- 触摸操作支持
- 优化的移动端键盘布局

## 🎵 演奏建议

### 简单练习
1. 单音练习: C-D-E-F-G-A-B-C
2. 音阶练习: Do-Re-Mi-Fa-Sol-La-Si-Do
3. 和弦练习: C-E-G (C大三和弦)

### 进阶演奏
- 使用延音踏板演奏连贯旋律
- 尝试左右手配合 (低音+高音)
- 练习不同的节奏型

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目！

## 📄 许可证

MIT License

## 🎼 致谢

感谢所有为Web Audio API和音频合成技术做出贡献的开发者们！

---

**享受您的网页钢琴演奏时光！** 🎹✨ 